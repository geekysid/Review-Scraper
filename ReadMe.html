<!DOCTYPE html>
<html>
<head>
<title>ReadMe.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<p align="center">
    <img src="https://user-images.githubusercontent.com/59141234/93002341-ff261d00-f553-11ea-874d-19ab5cb1068f.png" height="70px" />
</p>
<h4 align="center">
    Reviews Scraper
</h4>
<p align="center">
    Need to develope a toll where user can scrape reviews from a given URL from predefined sources.
    <br />
    <a href="https://www.upwork.com/nx/wm/workroom/32771669">
        Project Contract
    </a>
    &nbsp;&nbsp;·&nbsp;&nbsp;
    <a href="#">
        Client - Snehal (M2 Web Solutions)
    </a>
    &nbsp;&nbsp;·&nbsp;&nbsp;
    <a href="#">
        Status - On Going
    </a>
</p>
<!--  Details of Content  -->
<h3 id="table-of-contents">Table of contents</h3>
<ul>
<li><a href="#table-of-contents">Table of contents</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#db-schema">DB Schema</a></li>
<li><a href="#connect-to-db">Connect to DB</a></li>
<li><a href="#api-endpoints-base-url--http64227157110api2">API Endpoints (Base Url = http://64.227.157.110/api2)</a></li>
<li><a href="#flowchart">Flowchart</a></li>
<li><a href="#notes">Notes</a></li>
</ul>
<!--  Requirements  -->
<h3 id="requirements">Requirements</h3>
<p>Need to scraper reviews from below mentioned domains</p>
<ul>
<li>Booking.com</li>
<li>TripAdvisor.com</li>
<li>Trustpilot.com</li>
<li>Google.com</li>
</ul>
<p>Need to provide API end to the client. The client will use this API endpoint to push a URL and date parameters to initiate scraping. This API will return the Job ID of the scraper. We also need to provide one more API endpoint where the client will send the Job ID and will get all reviews and the status of the scraper.</p>
<!-- DB Schema -->
<h3 id="db-schema">DB Schema</h3>
<p>We will have 5 tables:</p>
<ul>
<li>
<p><strong>Status</strong>: Table that will have all the statuses that a job can have</p>
<ul>
<li><em>id</em>: id of the status</li>
<li><em>type</em>: type of status we will have (ADDED, QUEUED, RUNNING, COMPLETED, ERRORED)</li>
</ul>
</li>
<li>
<p><strong>source</strong>: Table that has a list of all sources from where we can scrape the data</p>
<ul>
<li><em>id</em>: Id of the source</li>
<li><em>name</em>: name of the source (booking.com, trustpilot.com, google.com, tripadvisor.com)</li>
</ul>
</li>
<li>
<p><strong>job</strong>: Table that will have the details doe each job</p>
<ul>
<li><em>id</em>: id of the job</li>
<li><em>url</em>: URL sent by the client through API</li>
<li><em>source</em>: name of the domain from which reviews are to be scrapped. Derived from the URL. Will be Foreign key to table <em>source</em></li>
<li><em>reviews_from_date</em>: the date from which reviews are to be scrapped. Derived from the URL</li>
<li><em>reviews_to_date</em>: the date up to which reviews are to be scrapped. Derived from the URL</li>
<li><em>status</em>: status of the job. Will be Foreign key to table <em>status</em></li>
<li><em>execution_start_date</em>: the date on which the scraper started execution.</li>
<li><em>execution_to_date</em>: the date on which the scraper completed execution.</li>
<li><em>date_added</em>: the date on which the job was created.</li>
<li><em>date_last_updated</em>: the date on which the job was last updated.</li>
<li><em>remarks</em>: the date on which the job was last updated.</li>
</ul>
</li>
<li>
<p><strong>tb_<source></strong>: Table that will have all scraped reviews. We will have different table to store review for different source. For example if source is <em>booking.com</em>, then review table for this source will be <em>tb_booking</em></p>
<ul>
<li><em>id</em>: id of review</li>
<li><em>job_id</em>: id of the job to, which the review is associated to. Foreign keys to table <em>job</em></li>
<li><em>review_date</em>: date of the review made</li>
<li><em>review_rating</em>: rating provided by the user</li>
<li><em>review_text</em>: review provided by the user</li>
<li><em>reviewer</em>: a person who made the review</li>
<li><em>services_used</em>: True if the reviewer has stayed in the hotel else false</li>
<li><em>other_metadata</em>: Any other metadata available to be saved as a key-value pair in the JSON format</li>
</ul>
</li>
<li>
<p><strong>log</strong>: Table that will have the Log files details</p>
<ul>
<li><em>id</em>: id of the log</li>
<li><em>job_id</em>: id of the job to, which the review is associated to. Foreign keys to table <em>job</em></li>
<li><em>added_on</em>: the date on which the log file was created</li>
<li><em>log_file</em>: name of the log file</li>
<li><em>path_to_file</em>: path where the log file is located</li>
<li><em>url_to_file</em>: URL from where we can download the log file</li>
</ul>
</li>
</ul>
<!-- Connect To DB -->
<h3 id="connect-to-db">Connect to DB</h3>
<ul>
<li><em>Host</em>: CHECK IN SERVER_DETAILS FILE</li>
<li><em>Database</em>: CHECK IN SERVER_DETAILS FILE</li>
<li><em>Username</em>: CHECK IN SERVER_DETAILS FILE</li>
<li><em>Password</em>: CHECK IN SERVER_DETAILS FILE</li>
<li><em>Port</em>: CHECK IN SERVER_DETAILS FILE</li>
</ul>
<!-- API Endpoints -->
<h3 id="api-endpoints-base-url--http64227157110api2">API Endpoints (Base Url = http://64.227.157.110/api2)</h3>
<ul>
<li>
<p><strong>/add</strong>: POST request using which user will send the URL from which reviews are to be scraped along with dates between which reviews are to be scrapped.</p>
<ul>
<li>
<p><em>Request</em>:</p>
<ul>
<li>
<p>url: Required. URL from which data is to be scrapped</p>
</li>
<li>
<p>review_to_date: Optional. Date after which reviews are to be scrapped. If provided should be in format of &quot;YYYY-MM-DD&quot;.</p>
</li>
<li>
<p>review_from_date: Optional. Date up to which reviews are to be scrapped. If provided should be in format of &quot;YYYY-MM-DD&quot;.</p>
<pre><code>  Request URL: http://64.227.157.110/api2/add/ 
  Sample Requests Payload:
  {
      &quot;url&quot;: &quot;https://www.booking.com/hotel/gb/jurys-inn-london-holborn.en-gb.html&quot;,
      &quot;review_to_date&quot;: &quot;2023-03-28&quot;,
      &quot;review_from_date&quot;: &quot;2023-03-01&quot;
  }
</code></pre>
</li>
</ul>
</li>
<li>
<p><em>Response</em>:</p>
<ul>
<li>
<p>job_id: returns the id of the job created in DB</p>
<pre><code>  Sample Response:
  {
      &quot;status&quot;: 201,
      &quot;source&quot;: &quot;Booking.com&quot;,
      &quot;job_id&quot;: 1002
  }
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>/status/&lt;job_id&gt;</strong>: GET request using which the user can get the status of the job</p>
<ul>
<li>
<p><em>Request</em>:</p>
<ul>
<li>
<p>job_id: Required. Id of the job for which status is required and is passed as the part of the url.</p>
<pre><code>  Sample URL: http://64.227.157.110/api2/status/2
</code></pre>
</li>
</ul>
</li>
<li>
<p><em>Response</em>:</p>
<ul>
<li>
<p>status: status of the job</p>
<pre><code>  Sample Response:
  {
      &quot;status&quot;: true,
      &quot;message&quot;: &quot;Job Found Successfully &quot;,
      &quot;data&quot;: {
          &quot;job_id&quot;: 2,
          &quot;url&quot;: &quot;https://www.tripadvisor.com/Restaurant_Review-g34515-d451087-Reviews-California_Grill_Lounge-Orlando_Florida.html&quot;,
          &quot;status&quot;: &quot;COMPLETED&quot;,
          &quot;reviews_from_date&quot;: &quot;1995-01-01T00:00:00Z&quot;,
          &quot;reviews_to_date&quot;: &quot;2023-03-25T00:00:00Z&quot;,
          &quot;remarks&quot;: &quot;Scraped all required Reviews&quot;
      }
  }
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>/reviews/&lt;job_id&gt;</strong>: GET request using which user can get reviews for a given job ID</p>
<ul>
<li>
<p><em>Request</em>:</p>
<ul>
<li>
<p>job_id: Required. id of the job for reviews are to be returned.</p>
<pre><code>  Sample URL: http://64.227.157.110/api2/reviews/2
</code></pre>
</li>
</ul>
</li>
<li>
<p><em>Response</em>:</p>
<ul>
<li>status: status of the job</li>
<li>reviews: list of all reviews
Sample Response:
{
&quot;status&quot;: 200,
&quot;source&quot;: &quot;Booking.com&quot;,
&quot;job_status&quot;: &quot;COMPLETED&quot;,
&quot;date_started&quot;: &quot;21/02/2023&quot;,
&quot;date_completed&quot;: &quot;21/02/2023&quot;,
&quot;reviews:&quot; []
}</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>/logs/<job-id></strong>: GET request using which the user will get the URL of the downloadable log file.</p>
<ul>
<li>
<p><em>Request</em>:</p>
<ul>
<li>
<p>job_id: Required. id of the job for reviews are to be returned.</p>
<pre><code>  Sample URL: http://64.227.157.110/api2/logs/2
</code></pre>
</li>
</ul>
</li>
<li>
<p><em>Response</em>:</p>
<ul>
<li>
<p>job_id: id of the job</p>
</li>
<li>
<p>log-file: URL of the log file</p>
<pre><code>  {
      &quot;status&quot;: true,
      &quot;message&quot;: &quot;Job Lod Data Found Successfully &quot;,
      &quot;data&quot;: [
          {
              &quot;id&quot;: 2,
              &quot;file_name&quot;: &quot;job-2__25-03-2023 23-15-18.log&quot;,
              &quot;path_to_file&quot;: &quot;/root/App/Logs/job-2__25-03-2023 23-15-18.log&quot;,
              &quot;url_to_file&quot;: &quot;&quot;,
              &quot;date_added&quot;: &quot;2023-03-25T23:15:18Z&quot;,
              &quot;job&quot;: 2
          }
      ]
  }
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Flowchart -->
<h3 id="flowchart">Flowchart</h3>
<p><img src="https://user-images.githubusercontent.com/59141234/219939491-cbf51efe-87b3-4da9-898f-1ae1b16cf979.jpg" alt="flowchart"></p>
<!-- Notes -->
<h3 id="notes">Notes</h3>
<ul>
<li>Proxy is to be used in every request</li>
</ul>

</body>
</html>
